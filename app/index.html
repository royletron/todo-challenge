<!DOCTYPE html>
<html>
<head>
	<title>React component</title>
	<link href="./main.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
	<link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
	<script src="https://fb.me/react-0.13.3.min.js"></script>
	<script src="https://fb.me/react-with-addons-0.14.3.min.js"></script>
	<script src="https://fb.me/react-dom-0.14.3.min.js"></script>
	<script src="https://fb.me/JSXTransformer-0.13.3.js"></script>
</head>
<body>
	<div id="react-container">
	</div>
	<script type="text/jsx">

		//not sure if note text should be stored here or in ToDoItem
		var ToDoList = React.createClass ({
			propTypes: {
				count: function(props, propName) {
					if (props[propName] > 7) {
						return new Error('Finish your todo list before adding more.')
					}
				}
			},

			getInitialState: function() {
				return ({itemIDs: [0], nextID: 1})
			},

			add: function () {
				var itemIDs = this.state.itemIDs;
				if (itemIDs.length < 7) {
					itemIDs.push(this.state.nextID);
					this.setState({itemIDs: itemIDs})
					this.incrementID();
				}
			},

			remove: function(id) {
				var itemIDs = this.state.itemIDs;
				var i = this.props.id;
				//itemIDs.splice(i, 1);
			},

			incrementID: function() {
				this.setState({nextID: this.state.nextID+1})
			},

			render: function() {
				var item = []
				for (var i of this.state.itemIDs) {
					   item.push(<li><ToDoItem ref={i}/></li>)
				}

				return (
					<div className="list-bg">
						<div id="listDiv" ref="list">
							<h1 className="listTitle">To do list</h1>
							<ul className="toDoItemList">
								{item}
							</ul>
						</div>
						<div id="addButtonDiv">
							<button type="button" onClick={this.add} className="addButton btn btn-primary glyphicon glyphicon-plus"/>
						</div>
					</div>
					);
			}
		})

		var ToDoItem = React.createClass ({

			//tracking three states: ticked, editing and text

			getInitialState: function() {
				return ({ticked: false, editing: true, text: "Enter text"})
			},

			handleTick: function() {
				//toggles state ticked
				//always sets editing to false
				this.setState({ticked: !this.state.ticked, editing: false})
			},

			edit: function () {
				//changes editing to true
				this.setState({editing: true})
			},

			save: function() {
				//changes editing to false and save new text state
				this.setState({editing: false, text: this.refs.itemText.value})
			},

			render: function() {

				//button display logic
				//essentially, there is only one button showing at a time for any combintation of states
				var displayDelete;
				if (this.state.ticked) {
					displayDelete = "" }
				else {
					displayDelete = "none"
				};

				var displayEdit;
				if (!this.state.ticked && !this.state.editing) {
					displayEdit = "" }
				else {
					displayEdit = "none"
				};

				var displaySave;
				if (!this.state.ticked && this.state.editing) {
					displaySave = "" }
				else {
					displaySave = "none"
				};

				var displayInput;
				var displayText;
				if (this.state.editing) {
					displayInput = "";
					displayText = "none";}
				else {
					displayInput = "none";
					displayText = "";
				};

				//item return consists of tickbox, input text and buttons for save, edit, delete
				return (
					<div>
						<form role="form">
							<div>
								<input onClick={this.handleTick} className="checkbox itemtickbox" type="checkbox" />
							</div>
							<div className="textDiv">
								<input type="input" ref="itemText" defaultValue={this.state.text} className="todo-input" style={{display: displayInput}}/>
								<p className="todo-text" style={{display: displayText}}>{this.state.text}</p>
							</div>
							<div id="functionButtonDiv">
								<div>
									<button type="button" onClick={this.save} className="btn btn-success glyphicon glyphicon-floppy-disk" style={{display: displaySave}}/>
								</div>
								<div>
									<button type="button" onClick={this.edit} className="btn btn-primary glyphicon glyphicon-pencil" style={{display: displayEdit}}/>
								</div>
								<div>
									<button type="button" onClick={this.remove} className="btn btn-danger glyphicon glyphicon-trash" style={{display: "none"}}/>
								</div>
							</div>
						</form>
					</div>
				);
			}

		})

		//calling render function
		ReactDOM.render(<ToDoList/>,
			document.getElementById('react-container'));

	</script>
</body>
</html>
